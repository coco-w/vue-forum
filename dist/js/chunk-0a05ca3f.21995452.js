(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a05ca3f"],{"4b5a":function(t,e,n){"use strict";var o=n("6665"),a=n.n(o);a.a},6665:function(t,e,n){},"91d8":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("header-nav",{ref:"user"}),n("div",{staticClass:"container"},[n("Anchor",{attrs:{"offset-top":100}},[n("AnchorLink",{attrs:{href:"#comment",title:"发表评论"}})],1),"1"===this.$route.params.page?n("Row",[n("i-col",{staticClass:"content",attrs:{span:"18",push:"3"}},[n("i-col",{staticClass:"col4",attrs:{span:"5"}},[n("div",{staticClass:"pic"},[n("img",{attrs:{src:t.doc.pic,alt:""}})]),n("div",{staticClass:"name"},[n("p",[t._v(t._s(t.doc.author))])])]),n("i-col",{staticClass:"col14",attrs:{span:"19"}},[n("div",{staticClass:"ql-editor",domProps:{innerHTML:t._s(t.doc.content)}})])],1)],1):t._e(),t._l(t.comments,function(e){return n("Row",{key:e._id,staticClass:"comments"},[n("i-col",{staticClass:"content",attrs:{span:"18",push:"3"}},[n("i-col",{staticClass:"col4",attrs:{span:"5"}},[n("div",{staticClass:"pic"},[n("img",{attrs:{src:e.pic,alt:""}})]),n("div",{staticClass:"name"},[n("p",[t._v(t._s(e.author))])])]),n("i-col",{staticClass:"col14",attrs:{span:"19"}},[n("div",{staticClass:"ql-editor",domProps:{innerHTML:t._s(e.content)}})])],1)],1)}),n("Row",{staticClass:"page"},[n("i-col",{attrs:{span:"18",push:"3"}},[n("Page",{attrs:{total:t.comments_length,current:t.page,"show-total":""},on:{"on-change":t.handlePageChange}})],1)],1),n("Row",{staticClass:"comment",attrs:{id:"comment"}},[n("i-col",{attrs:{span:"18",push:"3"}},[n("div",{staticClass:"edit_container"},[n("Editor",{model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}})],1)])],1),n("Row",{staticClass:"submit"},[n("i-col",{attrs:{span:"18",push:"3"}},[n("Button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("提交")])],1)],1)],2)],1)},a=[],s=(n("c5f6"),n("cebc")),i=n("c330"),c=n("ceb0"),r=n("2f62"),l={name:"topic",inject:["reload"],data:function(){return{comment:"",comments:[],doc:{},comments_length:0,offset:100,page:1}},components:{HeaderNav:i["a"],Editor:c["a"]},methods:Object(s["a"])({},Object(r["b"])(["getOneTopic","saveComment","getComment"]),{handleSubmit:function(){var t=this,e={};e.content=this.comment,e.author_id=this.$refs.user.id,e.topic_id=this.$route.params.id,this.saveComment(e).then(function(e){if(e.err_code)return t.$Message.error(e.message);t.$Message.success(e.message),t.reload()})},handlePageChange:function(t){this.$router.push("/topic/".concat(this.$route.params.id,"/").concat(t)),this.page=t,this.reload()}}),mounted:function(){var t=this;this.page=Number(this.$route.params.page),this.getOneTopic(this.$route.params.id).then(function(e){t.content=e.doc.content,t.doc=e.doc,t.comments_length=t.doc.comment.length;var n=Math.ceil(t.comments_length/10);t.page>n&&0!==n&&(t.$router.push("/topic/".concat(t.$route.params.id,"/").concat(n)),t.page=n,t.reload());var o=10*t.$route.params.page,a=e.doc.comment.slice(o-10,o);t.getComment(a).then(function(e){t.comments=e.doc})})}},u=l,d=(n("4b5a"),n("2877")),m=Object(d["a"])(u,o,a,!1,null,null,null);e["default"]=m.exports},ceb0:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Upload",{staticStyle:{display:"none"},attrs:{action:"/api/saveImg","on-progress":t.handleProgress,"on-success":t.handleSuccess,"on-error":t.handleError}},[n("Button",{staticClass:"saveImg",attrs:{icon:"ios-cloud-upload-outline"}})],1),n("quill-editor",{ref:"myQuillEditor",attrs:{content:t.value,options:t.editorOption},on:{blur:function(e){return t.onEditorBlur(e)},focus:function(e){return t.onEditorFocus(e)},change:function(e){return t.onEditorChange(e)}}})],1)},a=[],s=n("cebc"),i=n("bd86"),c=n("b881"),r=(n("3040"),n("cac2"),n("1e58"),n("2f62")),l=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]],u={name:"Editor",components:{quillEditor:c["quillEditor"]},props:{content:{type:String,default:""}},data:function(){var t;return{value:this.content,editorOption:(t={placeholder:"",theme:"snow"},Object(i["a"])(t,"placeholder","您想说点什么？"),Object(i["a"])(t,"modules",{toolbar:{container:l,handlers:{image:function(t){console.log("123"),t?document.querySelector(".saveImg").click():this.quill.format("image",!1)}}}}),t)}},methods:Object(s["a"])({},Object(r["b"])(["downLoadImg"]),{onEditorReady:function(t){},onEditorBlur:function(){},onEditorFocus:function(){},onEditorChange:function(t){t.editor;var e=t.html;t.text;this.value=e,this.$emit("input",this.value)},handleProgress:function(){},handleSuccess:function(t){var e=this.$refs.myQuillEditor.quill;if(200===t.code){var n=e.getSelection().index;e.insertEmbed(n,"image",t.path),e.setSelection(n+1)}else this.$message.error("图片插入失败")},handleError:function(){this.$message.error("图片插入失败")},handlerImage:function(){var t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("name","upload_file"),t.setAttribute("accept","image/png, image/gif, image/jpeg"),t.classList.add("ql-image"),console.log(t)}}),mounted:function(){}},d=u,m=n("2877"),p=Object(m["a"])(d,o,a,!1,null,null,null);e["a"]=p.exports}}]);